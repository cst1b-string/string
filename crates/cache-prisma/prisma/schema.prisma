datasource db {
    provider = "sqlite"
    url      = "file:dev.db"
}

generator client {
    provider = "cargo prisma"
    output   = "../src/prisma.rs"
}

model Network {
    id       Int       @id @default(autoincrement())
    name     String
    channels Channel[]
    users    User[]
}

model Message {
    id        Int      @id @default(autoincrement())
    content   String
    timestamp DateTime @default(now())
    author    User     @relation(fields: [authorId], references: [id])
    authorId  Bytes
    channel   Channel  @relation(fields: [channelId], references: [id])
    channelId Int
}

model Channel {
    id        Int       @id @default(autoincrement())
    title     String
    messages  Message[]
    network   Network   @relation(fields: [networkId], references: [id])
    networkId Int
}

model User {
    id        Bytes     @id
    username  String
    messages  Message[]
    network   Network   @relation(fields: [networkId], references: [id])
    networkId Int
    peer      Peer?
}

model Peer {
    id       Int      @id @default(autoincrement())
    user     User     @relation(fields: [userId], references: [id])
    userId   Bytes    @unique
    address  String
    port     Int
    lastSeen DateTime
}
